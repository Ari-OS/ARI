{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ARI Allowlists Configuration",
  "description": "Approved domains, tools, patterns, and integrations",
  "version": "11.0.0",
  
  "domains": {
    "description": "Approved external domains for network operations",
    "web_search": [
      "google.com",
      "bing.com",
      "duckduckgo.com",
      "perplexity.ai",
      "wikipedia.org"
    ],
    "documentation": [
      "docs.anthropic.com",
      "support.anthropic.com",
      "github.com",
      "stackoverflow.com",
      "developer.mozilla.org",
      "docs.python.org",
      "nodejs.org",
      "reactjs.org",
      "tailwindcss.com"
    ],
    "integrations": {
      "notion": ["api.notion.com", "www.notion.so"],
      "google": ["googleapis.com", "accounts.google.com", "calendar.google.com", "mail.google.com"],
      "slack": ["api.slack.com", "slack.com"],
      "github": ["api.github.com", "github.com"]
    },
    "blocked": [
      "localhost",
      "127.0.0.1",
      "0.0.0.0",
      "internal.*",
      "*.local"
    ]
  },
  
  "tools": {
    "description": "Approved tool categories and specific tools",
    
    "always_allowed": {
      "description": "Tools that can execute without additional approval",
      "categories": [
        "text_processing",
        "calculation",
        "formatting",
        "search_public"
      ],
      "specific": [
        "web_search",
        "calculator",
        "text_transform",
        "json_parse",
        "date_time"
      ]
    },
    
    "approval_required": {
      "description": "Tools requiring explicit operator approval",
      "categories": [
        "file_write",
        "email_send",
        "external_api",
        "financial",
        "social_media"
      ],
      "specific": [
        "file_create",
        "file_delete",
        "email_compose",
        "api_call_external",
        "calendar_create_event",
        "message_send"
      ]
    },
    
    "never_allowed": {
      "description": "Tools that are blocked under all circumstances",
      "categories": [
        "system_admin",
        "credential_access",
        "network_config"
      ],
      "specific": [
        "sudo_execute",
        "password_manager_access",
        "ssh_keygen",
        "firewall_modify",
        "user_create"
      ]
    }
  },
  
  "file_operations": {
    "description": "Allowed file paths and operations",
    
    "read_allowed": [
      "/home/*/documents/**",
      "/home/*/projects/**",
      "/tmp/ari/**",
      "${ARI_DATA_DIR}/**"
    ],
    
    "write_allowed": [
      "/home/*/documents/ari-output/**",
      "/tmp/ari/**",
      "${ARI_DATA_DIR}/**"
    ],
    
    "delete_allowed": [
      "/tmp/ari/**",
      "${ARI_DATA_DIR}/cache/**"
    ],
    
    "never_access": [
      "/etc/**",
      "/var/**",
      "/usr/**",
      "/bin/**",
      "/sbin/**",
      "**/.ssh/**",
      "**/.gnupg/**",
      "**/.*rc",
      "**/.*profile",
      "**/.env*"
    ],
    
    "allowed_extensions": {
      "read": [".md", ".txt", ".json", ".yaml", ".yml", ".csv", ".xml", ".html", ".css", ".js", ".ts", ".py", ".sh", ".pdf", ".doc", ".docx"],
      "write": [".md", ".txt", ".json", ".yaml", ".yml", ".csv", ".html", ".css", ".js", ".ts", ".py"],
      "blocked": [".exe", ".dll", ".so", ".dylib", ".bin", ".key", ".pem", ".p12"]
    }
  },
  
  "input_patterns": {
    "description": "Allowed and blocked input patterns",
    
    "blocked_patterns": [
      {
        "name": "prompt_injection_ignore",
        "pattern": "(?i)(ignore|disregard|forget).*(previous|above|prior).*(instructions?|rules?|guidelines?)",
        "severity": "critical",
        "action": "block_and_alert"
      },
      {
        "name": "prompt_injection_system",
        "pattern": "(?i)(you are now|act as if|pretend|roleplay|new instructions?|system prompt)",
        "severity": "high",
        "action": "flag_for_review"
      },
      {
        "name": "prompt_injection_jailbreak",
        "pattern": "(?i)(jailbreak|dan mode|developer mode|bypass|override safety)",
        "severity": "critical",
        "action": "block_and_alert"
      },
      {
        "name": "encoded_injection",
        "pattern": "(?i)(base64|rot13|hex decode|atob\\(|decode\\()",
        "severity": "medium",
        "action": "flag_for_review"
      },
      {
        "name": "credential_phishing",
        "pattern": "(?i)(password|api.?key|secret|token|credential).*(is|are|equals?|:|=)",
        "severity": "high",
        "action": "flag_for_review"
      }
    ],
    
    "allowed_special_chars": "!@#$%^&*()_+-=[]{}|;':\",./<>?~`",
    "max_input_length": 50000,
    "max_line_length": 10000
  },
  
  "output_patterns": {
    "description": "Patterns to filter from outputs",
    
    "redact_patterns": [
      {
        "name": "api_key",
        "pattern": "(?i)(api[_-]?key|apikey)[\"']?\\s*[:=]\\s*[\"']?([a-zA-Z0-9_-]{20,})",
        "replacement": "[REDACTED_API_KEY]"
      },
      {
        "name": "password",
        "pattern": "(?i)(password|passwd|pwd)[\"']?\\s*[:=]\\s*[\"']?([^\\s\"']{8,})",
        "replacement": "[REDACTED_PASSWORD]"
      },
      {
        "name": "token",
        "pattern": "(?i)(bearer|token)[\"']?\\s*[:=]\\s*[\"']?([a-zA-Z0-9._-]{20,})",
        "replacement": "[REDACTED_TOKEN]"
      },
      {
        "name": "ssn",
        "pattern": "\\b\\d{3}[-]?\\d{2}[-]?\\d{4}\\b",
        "replacement": "[REDACTED_SSN]"
      },
      {
        "name": "credit_card",
        "pattern": "\\b(?:\\d{4}[-\\s]?){3}\\d{4}\\b",
        "replacement": "[REDACTED_CC]"
      }
    ]
  },
  
  "integrations": {
    "description": "Approved third-party integrations and their scopes",
    
    "notion": {
      "enabled": false,
      "allowed_scopes": ["read_content", "read_comments"],
      "blocked_scopes": ["write_content", "delete_pages", "manage_users"],
      "rate_limit_per_hour": 100
    },
    
    "google_calendar": {
      "enabled": false,
      "allowed_scopes": ["read_events", "read_free_busy"],
      "blocked_scopes": ["write_events", "delete_events", "manage_calendars"],
      "rate_limit_per_hour": 100
    },
    
    "gmail": {
      "enabled": false,
      "allowed_scopes": ["read_messages", "read_labels"],
      "blocked_scopes": ["send_messages", "delete_messages", "manage_settings"],
      "rate_limit_per_hour": 50
    },
    
    "slack": {
      "enabled": false,
      "allowed_scopes": ["read_channels", "read_messages"],
      "blocked_scopes": ["send_messages", "manage_channels", "manage_users"],
      "rate_limit_per_hour": 100
    },
    
    "github": {
      "enabled": false,
      "allowed_scopes": ["read_repos", "read_issues", "read_prs"],
      "blocked_scopes": ["write_code", "manage_repos", "delete_repos"],
      "rate_limit_per_hour": 100
    }
  },
  
  "user_defined": {
    "description": "Placeholder for operator-defined allowlists",
    "custom_domains": [],
    "custom_tools": [],
    "custom_file_paths": [],
    "notes": "Operator can extend these lists during initialization"
  }
}
