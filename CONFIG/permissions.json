{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ARI Permission Configuration",
  "description": "Role-based access control and permission definitions",
  "version": "11.0.0",
  
  "trust_levels": {
    "system": {
      "level": 1.0,
      "description": "Internal system processes with full access",
      "inherits": null
    },
    "operator": {
      "level": 0.95,
      "description": "Human operator with administrative rights",
      "inherits": null
    },
    "verified": {
      "level": 0.8,
      "description": "Verified external sources or approved integrations",
      "inherits": null
    },
    "standard": {
      "level": 0.6,
      "description": "Standard operational trust for routine tasks",
      "inherits": null
    },
    "untrusted": {
      "level": 0.3,
      "description": "Unverified external input requiring scrutiny",
      "inherits": null
    },
    "hostile": {
      "level": 0.0,
      "description": "Detected malicious content - block all actions",
      "inherits": null
    }
  },
  
  "roles": {
    "arbiter": {
      "trust_level": "system",
      "permissions": [
        "governance.override",
        "governance.vote.cast",
        "governance.decision.final",
        "memory.read.all",
        "memory.write.verified",
        "agent.invoke.any",
        "config.read",
        "audit.read"
      ],
      "restrictions": [
        "config.modify.security"
      ]
    },
    
    "overseer": {
      "trust_level": "system",
      "permissions": [
        "governance.vote.cast",
        "governance.review.all",
        "governance.escalate",
        "memory.read.all",
        "memory.write.verified",
        "agent.invoke.any",
        "audit.read",
        "output.block"
      ],
      "restrictions": [
        "governance.override"
      ]
    },
    
    "guardian": {
      "trust_level": "system",
      "permissions": [
        "security.validate.all",
        "security.block",
        "security.alert",
        "memory.read.security",
        "audit.write",
        "input.sanitize",
        "output.filter"
      ],
      "restrictions": [
        "memory.write",
        "tool.execute"
      ]
    },
    
    "council_member": {
      "trust_level": "system",
      "permissions": [
        "governance.vote.cast",
        "governance.review.domain",
        "memory.read.domain",
        "agent.invoke.domain"
      ],
      "restrictions": [
        "governance.override",
        "config.modify"
      ]
    },
    
    "router": {
      "trust_level": "system",
      "permissions": [
        "agent.invoke.any",
        "memory.read.context",
        "request.classify"
      ],
      "restrictions": [
        "memory.write",
        "tool.execute",
        "output.send"
      ]
    },
    
    "planner": {
      "trust_level": "system",
      "permissions": [
        "plan.create",
        "plan.modify",
        "memory.read.context",
        "agent.recommend"
      ],
      "restrictions": [
        "tool.execute",
        "output.send.external"
      ]
    },
    
    "executor": {
      "trust_level": "system",
      "permissions": [
        "tool.execute.approved",
        "memory.write.working",
        "output.generate"
      ],
      "restrictions": [
        "tool.execute.unapproved",
        "memory.write.long_term"
      ]
    },
    
    "memory_manager": {
      "trust_level": "system",
      "permissions": [
        "memory.read.all",
        "memory.write.all",
        "memory.consolidate",
        "memory.archive"
      ],
      "restrictions": [
        "tool.execute",
        "output.send"
      ]
    },
    
    "domain_agent": {
      "trust_level": "standard",
      "permissions": [
        "memory.read.domain",
        "memory.write.working",
        "tool.execute.domain",
        "output.draft"
      ],
      "restrictions": [
        "memory.write.verified",
        "tool.execute.external",
        "output.send.final"
      ]
    }
  },
  
  "permissions": {
    "governance": {
      "override": {
        "description": "Override agent decisions",
        "min_trust": 0.95,
        "requires_audit": true,
        "requires_justification": true
      },
      "vote.cast": {
        "description": "Cast votes in council decisions",
        "min_trust": 0.8,
        "requires_audit": true
      },
      "decision.final": {
        "description": "Make final binding decisions",
        "min_trust": 0.95,
        "requires_audit": true,
        "requires_justification": true
      },
      "review.all": {
        "description": "Review all system outputs",
        "min_trust": 0.9
      },
      "escalate": {
        "description": "Escalate issues to higher authority",
        "min_trust": 0.7
      }
    },
    
    "memory": {
      "read.all": {
        "description": "Read all memory entries",
        "min_trust": 0.9
      },
      "read.domain": {
        "description": "Read domain-specific memories",
        "min_trust": 0.6
      },
      "read.context": {
        "description": "Read current context memories",
        "min_trust": 0.5
      },
      "write.all": {
        "description": "Write to any memory store",
        "min_trust": 0.95
      },
      "write.verified": {
        "description": "Write verified memories",
        "min_trust": 0.8,
        "requires_audit": true
      },
      "write.working": {
        "description": "Write to working memory",
        "min_trust": 0.6
      },
      "consolidate": {
        "description": "Consolidate memories",
        "min_trust": 0.9,
        "requires_audit": true
      }
    },
    
    "tool": {
      "execute.approved": {
        "description": "Execute pre-approved tools",
        "min_trust": 0.6
      },
      "execute.domain": {
        "description": "Execute domain-specific tools",
        "min_trust": 0.6
      },
      "execute.external": {
        "description": "Execute external API calls",
        "min_trust": 0.8,
        "requires_approval": true
      }
    },
    
    "security": {
      "validate.all": {
        "description": "Validate all inputs",
        "min_trust": 0.9
      },
      "block": {
        "description": "Block suspicious content",
        "min_trust": 0.8
      },
      "alert": {
        "description": "Raise security alerts",
        "min_trust": 0.7
      }
    },
    
    "config": {
      "read": {
        "description": "Read configuration",
        "min_trust": 0.6
      },
      "modify": {
        "description": "Modify configuration",
        "min_trust": 0.95,
        "requires_approval": true,
        "requires_audit": true
      },
      "modify.security": {
        "description": "Modify security configuration",
        "min_trust": 1.0,
        "requires_approval": true,
        "requires_audit": true,
        "operator_only": true
      }
    },
    
    "agent": {
      "invoke.any": {
        "description": "Invoke any agent",
        "min_trust": 0.8
      },
      "invoke.domain": {
        "description": "Invoke domain agents",
        "min_trust": 0.6
      }
    },
    
    "output": {
      "generate": {
        "description": "Generate output content",
        "min_trust": 0.5
      },
      "draft": {
        "description": "Create draft outputs",
        "min_trust": 0.5
      },
      "send.final": {
        "description": "Send final outputs to operator",
        "min_trust": 0.7
      },
      "block": {
        "description": "Block output from being sent",
        "min_trust": 0.9
      }
    },
    
    "audit": {
      "read": {
        "description": "Read audit logs",
        "min_trust": 0.8
      },
      "write": {
        "description": "Write audit entries",
        "min_trust": 0.8
      }
    }
  },
  
  "escalation_matrix": {
    "permission_denied": {
      "first_level": "guardian",
      "second_level": "overseer",
      "final_level": "arbiter"
    },
    "trust_violation": {
      "first_level": "guardian",
      "second_level": "arbiter",
      "final_level": "operator"
    },
    "policy_conflict": {
      "first_level": "overseer",
      "second_level": "arbiter",
      "final_level": "operator"
    }
  }
}
